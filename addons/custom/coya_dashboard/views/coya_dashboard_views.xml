<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Vue kanban principale du dashboard COYA -->
    <record id="view_coya_dashboard_kanban" model="ir.ui.view">
        <field name="name">coya.dashboard.kanban</field>
        <field name="model">coya.dashboard</field>
        <field name="arch" type="xml">
            <kanban class="coya-dashboard-kanban" create="false" quick_create="false">
                <templates>
                    <t t-name="card">
                        <div class="coya-dashboard-root o_kanban_record">
                            <div class="coya-dashboard-layout">
                                <!-- Sidebar -->
                                <aside class="coya-dashboard-sidebar">
                                    <div class="coya-dashboard-logo">
                                        <span class="coya-logo-circle">CP</span>
                                        <div class="coya-logo-text">
                                            <div class="coya-app-name">COYA.PRO</div>
                                            <div class="coya-app-subtitle">SENEGEL · ERP communautaire</div>
                                        </div>
                                    </div>
                                    <nav class="coya-dashboard-nav">
                                        <div class="coya-nav-section">Vue globale</div>
                                        <ul>
                                            <li class="is-active">Synthèse</li>
                                            <li>RH &amp; Trinité</li>
                                            <li>Projets</li>
                                            <li>Finances</li>
                                        </ul>
                                    </nav>
                                </aside>

                                <!-- Contenu central -->
                                <section class="coya-dashboard-main">
                                    <!-- Cartes Trinité -->
                                    <div class="coya-trinite-row">
                                        <div class="coya-trinite-card coya-trinite-productivite">
                                            <div class="coya-trinite-title">Productivité (Ndiguel)</div>
                                            <div class="coya-trinite-value">
                                                <t t-esc="record.trinite_productivite.value"/>%
                                            </div>
                                            <p class="coya-trinite-desc">
                                                Tâches clôturées vs toutes les tâches.
                                            </p>
                                        </div>
                                        <div class="coya-trinite-card coya-trinite-profitabilite">
                                            <div class="coya-trinite-title">Profitabilité (Yéene)</div>
                                            <div class="coya-trinite-value">
                                                <t t-esc="record.trinite_profitabilite.value"/>%
                                            </div>
                                            <p class="coya-trinite-desc">
                                                Factures clients payées vs factures postées.
                                            </p>
                                        </div>
                                        <div class="coya-trinite-card coya-trinite-professionnalisme">
                                            <div class="coya-trinite-title">Professionnalisme (Yar)</div>
                                            <div class="coya-trinite-value">
                                                <t t-esc="record.trinite_professionnalisme.value"/>%
                                            </div>
                                            <p class="coya-trinite-desc">
                                                Employés actifs vs effectif total.
                                            </p>
                                        </div>
                                    </div>

                                    <!-- KPIs globaux -->
                                    <div class="coya-kpi-row">
                                        <div class="coya-kpi-card">
                                            <div class="coya-kpi-label">Employés</div>
                                            <div class="coya-kpi-value">
                                                <t t-esc="record.total_employee_count.value"/>
                                            </div>
                                        </div>
                                        <div class="coya-kpi-card">
                                            <div class="coya-kpi-label">Projets</div>
                                            <div class="coya-kpi-value">
                                                <t t-esc="record.total_project_count.value"/>
                                            </div>
                                        </div>
                                        <div class="coya-kpi-card">
                                            <div class="coya-kpi-label">Tâches ouvertes</div>
                                            <div class="coya-kpi-value">
                                                <t t-esc="record.open_task_count.value"/>
                                            </div>
                                        </div>
                                        <div class="coya-kpi-card">
                                            <div class="coya-kpi-label">Factures clientes postées</div>
                                            <div class="coya-kpi-value">
                                                <t t-esc="record.open_invoice_count.value"/>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="coya-dashboard-hint">
                                        <p>
                                            Ce dashboard est un premier socle COYA.PRO. Les sections RH, Projets et
                                            Finances pourront être enrichies avec des graphes et listes dédiés
                                            (Budget vs Réalisé, suivi des justificatifs, etc.).
                                        </p>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Action et menu -->
    <record id="action_coya_dashboard" model="ir.actions.act_window">
        <field name="name">COYA Dashboard</field>
        <field name="res_model">coya.dashboard</field>
        <field name="view_mode">kanban</field>
        <field name="view_id" ref="view_coya_dashboard_kanban"/>
        <field name="target">current</field>
        <field name="help" type="html">
            <p>Dashboard global COYA.PRO avec Trinité et KPIs.</p>
        </field>
    </record>

    <!-- Enregistrement initial (singleton) -->
    <record id="coya_dashboard_main" model="coya.dashboard">
        <field name="name">COYA Dashboard</field>
    </record>

    <menuitem id="menu_coya_dashboard"
              name="Tableau de bord"
              parent="senegal_base.menu_coya_root"
              action="action_coya_dashboard"
              sequence="5"/>
</odoo>

