<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Titre + favicon : COYA.PRO (remplace Odoo) -->
    <template id="sunugest_web_layout" inherit_id="web.layout">
        <xpath expr="//title" position="replace">
            <title>COYA ERP · SENEGEL</title>
        </xpath>
        <xpath expr="//link[@rel='shortcut icon' or (@rel='icon' and not(@sizes))]" position="replace">
            <link type="image/png" rel="icon" href="/sunugest_branding/static/img/logo_senegel.png"/>
        </xpath>
    </template>

    <!-- Footer / promotion : SENEGEL · COYA.PRO au lieu de Powered by Odoo -->
    <template id="sunugest_brand_promotion" inherit_id="web.brand_promotion">
        <xpath expr="//div[contains(@class, 'o_brand_promotion')]" position="replace">
            <div class="o_brand_promotion">
                <a href="https://www.senegel.org" target="_blank" rel="noopener">SENEGEL · COYA.PRO</a>
                <span> — </span>
                <a href="mailto:techsupport@senegel.org">techsupport@senegel.org</a>
            </div>
        </xpath>
    </template>

    <!-- Page de login : layout deux panneaux COYA (gauche = formulaire, droite = bienvenue + Trinité) -->
    <template id="sunugest_login_layout_coya" inherit_id="web.login_layout" priority="50">
        <xpath expr="//div[contains(@class, 'container') and contains(@class, 'py-5')]" position="replace">
            <main class="coya-login-page">
                <div class="coya-login-split">
                    <!-- Panneau gauche : logo, formulaire -->
                    <div class="coya-login-left">
                        <div class="coya-login-brand">
                            <div class="coya-login-logo-circle">
                                <img src="/sunugest_branding/static/img/logo_senegel.png" alt="COYA.PRO"/>
                            </div>
                            <p class="coya-login-slogan">CITOYENNETÉ, TRANSPARENCE, COMPÉTENCES</p>
                            <h2 class="coya-login-title">COYA.PRO</h2>
                        </div>
                        <div class="coya-login-card card border-0">
                            <div class="card-body">
                                <t t-out="0"/>
                                <div class="text-center small mt-4 pt-3 border-top" t-if="not disable_footer">
                                    <t t-if="not disable_database_manager">
                                        <a class="border-end pe-2 me-1" href="/web/database/manager">Gérer les bases</a>
                                    </t>
                                    <a href="https://www.senegel.org" target="_blank" rel="noopener">SENEGEL · COYA.PRO</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Panneau droit : bloc institutionnel stratégique -->
                    <div class="coya-login-right">
                        <div class="coya-login-hero">
                            <h2 class="coya-login-hero-title">Plateforme stratégique de gestion et d'accompagnement de la jeunesse africaine</h2>
                            <p class="coya-login-hero-subtitle">Pilotage, transparence et performance au service de l'impact social.</p>
                        </div>
                        <div class="coya-login-metrics">
                            <div class="coya-metric"><span class="coya-metric-value">+500</span><span class="coya-metric-label">Bénéficiaires</span></div>
                            <div class="coya-metric"><span class="coya-metric-value">45</span><span class="coya-metric-label">Projets</span></div>
                            <div class="coya-metric"><span class="coya-metric-value">12</span><span class="coya-metric-label">Partenaires</span></div>
                            <div class="coya-metric"><span class="coya-metric-value">92%</span><span class="coya-metric-label">Taux de réussite</span></div>
                        </div>
                        <div class="coya-login-pillars">
                            <div class="coya-pillar-card">
                                <span class="coya-pillar-icon"><i class="fa fa-users" aria-hidden="true"/></span>
                                <h3 class="coya-pillar-title">Ndiguel — Leadership &amp; Engagement</h3>
                                <p class="coya-pillar-desc">Développement du sens civique et responsabilité sociale.</p>
                            </div>
                            <div class="coya-pillar-card">
                                <span class="coya-pillar-icon"><i class="fa fa-line-chart" aria-hidden="true"/></span>
                                <h3 class="coya-pillar-title">Barké — Performance &amp; Productivité</h3>
                                <p class="coya-pillar-desc">Optimisation des ressources et pilotage des projets.</p>
                            </div>
                            <div class="coya-pillar-card">
                                <span class="coya-pillar-icon"><i class="fa fa-graduation-cap" aria-hidden="true"/></span>
                                <h3 class="coya-pillar-title">Yar — Professionnalisation</h3>
                                <p class="coya-pillar-desc">Insertion, formation, employabilité.</p>
                            </div>
                        </div>
                        <div class="coya-login-trust">
                            <p class="coya-trust-tagline">Données sécurisées · Traçabilité · Transparence financière · Reporting en temps réel</p>
                        </div>
                        <p class="coya-login-vision">Une plateforme conçue pour les réalités africaines, alignée aux standards internationaux de gouvernance.</p>
                        <div class="coya-login-credit">
                            <a href="https://www.senegel.org" target="_blank" rel="noopener">senegel.org</a>
                            · <a href="mailto:techsupport@senegel.org">techsupport@senegel.org</a>
                        </div>
                    </div>
                </div>
            </main>
        </xpath>
    </template>

    <!-- Formulaire de login : libellés et bouton en français -->
    <template id="sunugest_login_form_fr" inherit_id="web.login" priority="99">
        <xpath expr="//label[@for='db']" position="replace">
            <label for="db" class="col-form-label">Base de données</label>
        </xpath>
        <xpath expr="//a[@href='/web/database/selector']" position="replace">
            <a role="button" href="/web/database/selector" class="btn btn-secondary">Choisir <i class="fa fa-database" role="img" aria-label="Base de données" title="Base de données"></i></a>
        </xpath>
        <xpath expr="//label[@for='login']" position="replace">
            <label for="login" class="form-label d-flex justify-content-between">Adresse e-mail</label>
        </xpath>
        <xpath expr="//input[@name='login']" position="attributes">
            <attribute name="placeholder">Adresse e-mail</attribute>
        </xpath>
        <xpath expr="//label[@for='password']" position="replace">
            <label for="password" class="form-label d-flex justify-content-between">Mot de passe</label>
        </xpath>
        <xpath expr="//input[@id='password']" position="attributes">
            <attribute name="placeholder">Mot de passe</attribute>
        </xpath>
        <xpath expr="//div[contains(@class, 'oe_login_buttons')]//button[@type='submit' and not(@name='redirect')]" position="replace">
            <button type="submit" class="btn btn-primary">Connexion</button>
        </xpath>
        <xpath expr="//button[@name='redirect']" position="replace">
            <button type="submit" name="redirect" value="/web/become" class="btn btn-link btn-sm">Connexion superutilisateur</button>
        </xpath>
    </template>

    <!-- Page « Vous êtes connecté » : textes en français -->
    <template id="sunugest_login_successful_fr" inherit_id="web.login_successful" priority="99">
        <xpath expr="//div[contains(@class, 'oe_login_form')]/p" position="replace">
            <p>Vous êtes connecté.</p>
        </xpath>
        <xpath expr="//a[contains(@href, '/web/session/logout')]" position="replace">
            <a class="btn btn-primary btn-block" href="/web/session/logout">Déconnexion</a>
        </xpath>
    </template>

    <!-- Page « Hors ligne » : charte COYA.PRO / SENEGEL (vert + jaune) -->
    <template id="coya_offline" inherit_id="web.webclient_offline">
        <xpath expr="//t[@t-set='title']" position="replace">
            <t t-set="title">COYA.PRO — Hors ligne</t>
        </xpath>
        <xpath expr="//t[@t-set='head']" position="replace">
            <t t-set="head">
                <script type="text/javascript">
                    document.addEventListener("DOMContentLoaded", () => {
                        const cookies = document.cookie.split(';').map(c => c.trim());
                        if (cookies.includes('color_scheme=dark')) {
                            document.body.style.backgroundColor = "#1a2e24";
                            document.body.style.color = "#F4F8FB";
                        }
                    });
                    window.addEventListener('online', () => location.reload());
                </script>
                <style>
                    body {
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                        padding: 0; margin: 0;
                        background: linear-gradient(135deg, #a8e6cf 0%, #7dd3a8 40%, #2d8a5a 70%, #1a5f3a 100%);
                        color: #1a5f3a;
                        display: flex; align-items: center; justify-content: center; text-align: center;
                        min-height: 100vh; width: 100vw; user-select: none;
                    }
                    .card {
                        background: rgba(255,255,255,0.97);
                        border-radius: 1rem;
                        padding: 2.5rem;
                        box-shadow: 0 8px 32px rgba(0,0,0,0.12);
                        border: 1px solid rgba(26,95,58,0.2);
                        max-width: 420px;
                    }
                    .card .coya-offline-logo {
                        width: 100px; height: auto; margin-bottom: 1rem;
                    }
                    .card h1 { color: #1a5f3a; font-size: 1.5rem; font-weight: 700; margin-bottom: 0.75rem; }
                    .card p { color: #247a4a; font-size: 0.95rem; margin-bottom: 1.5rem; line-height: 1.5; }
                    .card button {
                        background: #e8b923;
                        color: #1a5f3a;
                        border: 2px solid #1a5f3a;
                        border-radius: 0.5rem;
                        padding: 0.6rem 1.5rem;
                        cursor: pointer;
                        font-size: 1rem;
                        font-weight: 700;
                    }
                    .card button:hover { background: #f0c94a; filter: brightness(1.05); }
                </style>
                <meta name="viewport" content="width=device-width, initial-scale=1"/>
            </t>
        </xpath>
        <xpath expr="//div[contains(@class, 'card')]" position="replace">
            <div class="card">
                <img class="coya-offline-logo" src="/sunugest_branding/static/img/logo_senegel.png" alt="SENEGEL"/>
                <h1>Vous êtes hors ligne</h1>
                <p>Vérifiez votre connexion réseau et revenez ici. COYA.PRO se rechargera dès que vous serez en ligne.</p>
                <p class="small mt-2"><a href="mailto:techsupport@senegel.org" style="color: #1a5f3a; font-weight: 600;">Assistance : techsupport@senegel.org</a></p>
                <button type="button" onclick="location.reload()">Revérifier</button>
            </div>
        </xpath>
    </template>
</odoo>
